Данная инструкция содержит пояснения насчёт подключения и использования дополнительных модулей, необходимых для создания "Беспилотного судна".



//////// МАГНИТОМЕТР HMC5883l ////////////////

В данном проекте магнитометр HMC5883l как часть модуля NEO7M используется для получения азимута, служащим орентиром для определения пеленга судна(Направления, в которое оно повёрнуто).


// Подключение HMC5883l к Arduino //
Для передачи данных HMC5883l использует протокол I2C. 

--NEO7M--      --Arduino Nano V3--

VCC       --->    5V*
SDA       --->    A4**
SCL       --->    A5**
GND       --->    GND

*Примечание: Если HMC5883l используется как отдельный модуль, то на питание следует подавать 3,3V!
**Примечание: Данные пины актуальны для Arduino Nano V3, для других моделей пины для I2C могут отличаться!


// Библиотека для работы с HMC5883l //
Под Ардуино для HMC5883l существует готовая библиотека "Arduino-HMC5883L" от пользователя github "jarzebski"(https://github.com/jarzebski/Arduino-HMC5883L).
Её преимущество в том, что она позволяет так же произвести необходимую калибровку устройства для получения правильных показаний.  

Так же для обмена данных между устройствами по I2C понадобится подключить встроенную библиотеку <Wire.h>


// Калибровка HMC5883l //
Для начала калибровки необходимо загрузить файл "HMC5883L-calibrate", прилогаемый в качестве одного из примеров к вышеназванной библиотеке.
Сначала необходимо внести в него некоторые изменения. А именно в конце программы оставить для вывода через Serial порт только значения переменных offX и offY.

Далее прошиваем этим кодом Arduino. Открываем COM-порт, настраиваем нужную скорость и видим данные, которые Arduino принимает с HMC5883l и передаёт на компьютер.
Если данные не появляются, то следует:
*Проверить правильность соединения NEO7M(Или HMC5883l) с Arduino.
*Праверить, правильно ли мы отредактировали код.
*Проверить скорость, выставленную для просмотра данных со стороны PC

Для удобства можно закрепить всю нашу систему на стенде(основанием может послужить скажем дошечка, коробка и т.д).
Оставляя Arduino подлюченной к PC, отодвигаем всю систему как можно дальше от любых электронных приборов.
Начинаем медленно вращать стенд в горизонтальной плоскости по часовой стрелки до тех пор, пока значения с COM-порта не перестанут изменяться(обычно 3-4 поворота). Затем сделаем тоже самое против часовой стрелки.

В случае, если данные на COM порте более не меняют значение от поворота, их необходимо записать. Данный алгоритм следует повторить несколько раз, какждый раз перезагружая Arduino. Должны получится примерно одинаковые значения.
